<!DOCTYPE html>
<html>
<head>
<title>UHK layout</title>
<meta charset="utf-8">
</head>
<body>
<div id="layout"></div>
<script src="components/jquery/dist/jquery.min.js"></script>
<script src="components/svg.js/dist/svg.min.js"></script>
<script src="svg.parser.min.js"></script>
<script src="components/svg.import.js/svg.import.min.js"></script>
<script>
var root, layout;

var fontSize = 25;
var keycapHeight;
var bottomKeycapHeight;
var keycapHeightInMm = 18;
var fontHeight;

var labelGap;
var bottomLabelGap;

$.get('layout.svg', function(data) {
    var serializer = new XMLSerializer();
    var rawSvg = serializer.serializeToString(data);
    root = SVG('layout').svg(rawSvg);
    layout = root.roots()[0];

    var text = layout.text('A').font({family:'Helvetica', size:fontSize, anchor:'middle'}).addTo(SVG.get('left-parts'));
    fontHeight = text.bbox().height;
    text.remove();

    keycapHeight = SVG.get('a1').height();
    bottomKeycapHeight = SVG.get('f1').height();
    labelGap = (keycapHeight - fontHeight) / 2;
    bottomLabelGap = (bottomKeycapHeight - fontHeight) / 2;

    $.each(mouseLayer, function(i, n) {
        labelKeycap(i, n);
    });
});

function labelKeycap(keycapId, label)
{
    var key = root.get(keycapId);
    var labelGapY = keycapId.charAt(0) == 'f' ? bottomLabelGap : labelGap;
    var text = layout.
        text(label).
        font({family:'Helvetica', size:fontSize, anchor:'middle'}).
        fill('#fff').
        move(key.x()+key.width()/2, key.y()+labelGapY).
        addTo(key.parent);
}

function showOnlyKeycapTops()
{
    var shrinkBy = mmToSvgUnit(3);
    $.each(labels, function(i, n) {
        if (i.charAt(0) != 'f') {
            var key = root.get(i);
            key.width(key.width()-shrinkBy);
            key.height(key.height()-shrinkBy);
            key.x(key.x() + shrinkBy/2);
            key.y(key.y() + shrinkBy/2);
        }
    });
    SVG.get('left-case').hide();
    SVG.get('right-case').hide();
}

function mmToSvgUnit(mm)
{
    return (keycapHeight / keycapHeightInMm) * mm;
}

var baseLayer = {
    'a1' : '`',
    'a2' : '1',
    'a3' : '2',
    'a4' : '3',
    'a5' : '4',
    'a6' : '5',
    'a7' : '6',
    'a8' : '7',
    'a9' : '8',
    'a10': '9',
    'a11': '0',
    'a12': '-',
    'a13': '=',
    'a14': '←',
    'b1' : 'Tab',
    'b2' : 'Q',
    'b3' : 'W',
    'b4' : 'E',
    'b5' : 'R',
    'b6' : 'T',
    'b7' : 'Y',
    'b8' : 'U',
    'b9' : 'I',
    'b10': 'O',
    'b11': 'P',
    'b12': '[',
    'b13': ']',
    'b14': '\\',
    'c1' : 'Mouse',
    'c2' : 'A',
    'c3' : 'S',
    'c4' : 'D',
    'c5' : 'F',
    'c6' : 'G',
    'c7' : 'H',
    'c8' : 'J',
    'c9' : 'K',
    'c10': 'L',
    'c11': ';',
    'c12': '\'',
    'c13': 'Enter',
    'd1' : 'Shift',
    'd2' : 'Z',
    'd3' : 'X',
    'd4' : 'C',
    'd5' : 'V',
    'd6' : 'B',
    'd7' : 'N',
    'd8' : 'M',
    'd9' : ',',
    'd10': '.',
    'd11': '/',
    'd12': 'Shift',
    'e1' : 'Super',
    'e2' : 'Ctrl',
    'e3' : 'Alt',
    'e4' : 'Fn',
    'e5' : 'Mod',
    'e6' : 'Space',
    'e7' : 'Fn',
    'e8' : 'Alt',
    'e9' : 'Ctrl',
    'e10': 'Super',
    'f1' : 'Space',
    'f2' : 'Mod',
};

var modLayer = {
    'a1' : 'Esc',
    'a2' : 'F1',
    'a3' : 'F2',
    'a4' : 'F3',
    'a5' : 'F4',
    'a6' : 'F5',
    'a7' : 'F6',
    'a8' : 'F7',
    'a9' : 'F8',
    'a10': 'F9',
    'a11': 'F10',
    'b2' : 'close\ntab',
    'b3' : 'prev\ntab',
    'b4' : 'new\ntab',
    'b5' : 'next\ntab',
    'b7' : 'PgUp',
    'b8' : 'Home',
    'b9' : '↑',
    'b10': 'End',
    'b11': 'Delete',
    'c4' : 'Alt\nTab',
    'c7' : 'PgDn',
    'c8' : '←',
    'c9' : '↓',
    'c10': '→',
    'c11': 'Insert',
}

var fnLayer = {
    'b8' : 'Play',
    'b9' : 'Vol\nUp',
    'b10': 'Pause',
    'c8' : 'Prev\nTrack',
    'c9' : 'Vol\nDown',
    'c10': 'Next\nTrack',
    'd9': 'Mute',
}

var mouseLayer = {
    'c3' : 'right\nclick',
    'c4' : 'middle\nclick',
    'c5' : 'left\nclick',
    'b9' : '↑',
    'c8' : '←',
    'c9' : '↓',
    'c10': '→',
}

</script>
</body>
